<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
   <link rel="stylesheet" href="/ws22_ulg_ds_julia/libs/highlight/github.min.css">
   
    <script src="/ws22_ulg_ds_julia/libs/clipboard.min.js"></script>
  
  
  <script src="/ws22_ulg_ds_julia/libs/plotly-1_58_5.min.js"></script> 
  <script>
    // This function is used when calling `\fig{...}` See # Using \fig{...} below
    const PlotlyJS_json = async (div, url) => {
      response = await fetch(url); // get file
      fig = await response.json(); // convert it to json
      // Make the plot fit the screen responsively. See the documentation of plotly.js. https://plotly.com/javascript/responsive-fluid-layout/
      if (typeof fig.config === 'undefined') { fig["config"]={} }
      delete fig.layout.width
      delete fig.layout.height
      fig["layout"]["autosize"] = true
      fig["config"]["autosizable"] = true
      fig["config"]["responsive"] = true

      // make it easier to scroll throught the website rather than being blocked by a figure.
      fig.config["scrollZoom"] = false

      // PlotlyJS.savefig by default add the some more attribute to make a static plot.
      // Disable them to make the website fancier.
      delete fig.config.staticPlot
      delete fig.config.displayModeBar
      delete fig.config.doubleClick
      delete fig.config.showTips

      Plotly.newPlot(div, fig);
    };
  </script>
  
  <link rel="stylesheet" href="/ws22_ulg_ds_julia/css/jtd.css">
<link rel="stylesheet" href="/ws22_ulg_ds_julia/css/extras.css">
<link rel="icon" href="/ws22_ulg_ds_julia/assets/favicon.ico">

<style>
  /* #148 wrap long header */
  .franklin-content a.header-anchor,
  .franklin-toc li a
   {
    word-wrap: break-word;
    white-space: normal;
  }
</style>

   <title>Introduction - Macros</title>  
</head>
<body>                      <!-- closed in foot.html -->
<div class="page-wrap">   <!-- closed in foot.html -->
  <!-- SIDE BAR -->
  <div class="side-bar">
    <div class="header">
      <a href="/ws22_ulg_ds_julia/" class="title">
        Julia
      </a>
    </div>
    <label for="show-menu" class="show-menu">MENU</label>
    <input type="checkbox" id="show-menu" role="button">
    <div class="menu" id="side-menu">
      <ul class="menu-list">
        <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/" class="menu-list-link ">Start</a>
        <li class="menu-list-item active"><a href="/ws22_ulg_ds_julia/pages/introduction/" class="menu-list-link active">Introduction</a>
          <ul class="menu-list-child-list ">
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/introduction/basis_datatypes_and_operations/" class="menu-list-link ">Basic Data Types and Operations</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/introduction/package_manager/" class="menu-list-link ">Package Manager</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/introduction/matrix_vectors/" class="menu-list-link ">Matrix and Vector Operations</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/introduction/conditional_evaluations/" class="menu-list-link ">Conditional evaluations</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/introduction/loops/" class="menu-list-link ">Loops</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/introduction/functions/" class="menu-list-link ">Functions</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/introduction/macros/" class="menu-list-link active">Macros</a>
          </ul>
        <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/data_management/" class="menu-list-link ">Data Management</a>
          <ul class="menu-list-child-list ">
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/data_management/loading_data/" class="menu-list-link ">Loading data</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/data_management/saving_data/" class="menu-list-link ">Saving data</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/data_management/exploratory_da/" class="menu-list-link ">Exploratory Data Analysis</a>
            <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/data_management/datasets/" class="menu-list-link ">Data Sets</a>
          </ul>
          <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/neural_networks/" class="menu-list-link ">Neural Networks</a>
          <li class="menu-list-item "><a href="/ws22_ulg_ds_julia/pages/reporting/" class="menu-list-link ">Reporting</a>
      </ul>
    </div>
    <div class="footer">
      This is <em>Just the docs</em>, adapted from the <a href="https://github.com/pmarsceill/just-the-docs" target="_blank">Jekyll theme</a>.
    </div>
  </div>
  <!-- CONTENT -->
  <div class="main-content-wrap"> <!-- closed in foot.html -->
    <div class="main-content">    <!-- closed in foot.html -->
      <div class="main-header">
        SS22 Julia Workshop Obergurgl
      </div>



<!-- Content appended here (in class franklin-content) -->
<div class="franklin-content"><h1 id="macros"><a href="#macros" class="header-anchor">Macros</a></h1>
<p><a href="https://docs.julialang.org/en/v1/manual/metaprogramming/#man-macros">Macros</a> are a very powerful concept in Julia and we will use them throughout the next sessions. The main idea of macros is to allow the generation of code in the final body of a program. At its basis, a macro is similar to a function, as it maps a tuple of arguments to a returned expression.  Therefore, in order to distinguish macros in the code, Julia reserves the <code>@</code> symbol as the first character for macro definitions.  Apart from that convention, there are two major differences between macros and functions. A macro:</p>
<ol>
<li><p>is compiled directly and not at the first call,</p>
</li>
<li><p>is executed when the code is parsed.</p>
</li>
</ol>
<p>The second feature is the important one, as we can manipulate the code at runtime. The nice thing about macros is, we can insert quite powerful code by still keeping the readability high.  Later on we will see how this works, but let us keep it simple to begin with.  </p>
<p>An easy example from the <a href="https://docs.julialang.org/en/v1/manual/metaprogramming/#man-macros">Julia documentation on macros</a> is:</p>
<pre><code class="julia-repl hljs"><span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-keyword">macro</span> sayhello(name)
          <span class="hljs-keyword">return</span> :( println(<span class="hljs-string">&quot;Hello, &quot;</span>, $name) )
       <span class="hljs-keyword">end</span>
</span>@sayhello (macro with 1 method)

<span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-meta">@sayhello</span>(<span class="hljs-string">&quot;student n&quot;</span>)
</span>Hello, student n

<span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-meta">@sayhello</span> <span class="hljs-string">&quot;student n+1&quot;</span>
</span>Hello, student n+1</code></pre>
<p>One thing to note here is, that in the REPL the macro is executed immediately and we see the result right away. </p>
<p>It would not be Julia if there was not a macro that can be used to view what a macro is actually doing with an argument.  This is the <code>@macroexpand</code> macro:</p>
<pre><code class="julia-repl hljs"><span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-meta">@macroexpand</span> <span class="hljs-meta">@sayhello</span> <span class="hljs-string">&quot;Student n+1&quot;</span>
</span>:(Main.println(&quot;Hello, &quot;, &quot;Student n+1&quot;))</code></pre>
<p>Of course we can also use the other features of Julia with macros, like multiple dispatch, which is something for the exercise. </p>
<button type="button" class="collapsible" style="background-color:#b5ddff"> Exercise </button><div class="collapsiblecontent">  Program the following tasks.</p>
<ol>
<li><p>Write a macro <code>m</code> with different invocations for one argument and for two arguments &#40;just print <code>x arguments</code> as return value&#41;. </p>
</li>
<li><p>Add a version where the input is an integer and test with <code>@m 1</code></p>
</li>
<li><p>What happens when you run the code </p>
</li>
</ol>
<pre><code class="julia hljs">x = <span class="hljs-number">1</span>
<span class="hljs-meta">@m</span> x</code></pre>
<p><div class="solution"> Solution </div><div class="solutioncollapsible">  </p>
<pre><code class="julia-repl hljs"><span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-keyword">macro</span> m(x)
           <span class="hljs-keyword">return</span> :( println(<span class="hljs-string">&quot;One arguments&quot;</span>) )
       <span class="hljs-keyword">end</span>
</span>@m (macro with 1 method)

<span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-keyword">macro</span> m(x, y)
           <span class="hljs-keyword">return</span> :( println(<span class="hljs-string">&quot;Two arguments&quot;</span>) )
       <span class="hljs-keyword">end</span>
</span>@m (macro with 2 methods)

<span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-keyword">macro</span> m(::<span class="hljs-built_in">Int</span>)
           <span class="hljs-keyword">return</span> :( println(<span class="hljs-string">&quot;An Integer&quot;</span>) )
       <span class="hljs-keyword">end</span>
</span>@m (macro with 3 methods)

<span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-meta">@m</span> <span class="hljs-number">1</span>
</span>An Integer

<span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-meta">@m</span> x y
</span>Two arguments

<span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> x = <span class="hljs-number">1</span>
</span>1

<span class="hljs-meta prompt_">julia&gt;</span><span class="language-julia"> <span class="hljs-meta">@m</span> x
</span>One arguments</code></pre>
<p></div> </div>
<div class="page-foot">
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> - <a href="https://www.uibk.ac.at/mathematik/personal/antholzer/">Stephan Antholzer</a>, <a href="https://ehrensperger.dev/">Gregor Ehrensperger</a>, <a href="https://igs.uibk.ac.at/igs_html/members/IGSMember_Sappl.html">Johannes Sappl</a>. Last modified: October 19, 2022.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div><!-- CONTENT ENDS HERE -->
    </div> <!-- end of class main-content -->
    </div> <!-- end of class main-content-wrap -->
    </div> <!-- end of class page-wrap-->
    
    
      


      <script>
    (function(){
    
      // Get the elements.
      // - the 'pre' element.
      // - the 'div' with the 'paste-content' id.
    
      var pre = document.getElementsByTagName('pre');
    
      // Add a copy button in the 'pre' element.
      // which only has the className of 'language-'.
    
      for (var i = 0; i < pre.length; i++) {
        var isLanguage = pre[i].children[0].tagName == 'CODE';
    
        if ( isLanguage ) {
          var button           = document.createElement('button');
              button.className = 'copy-button';
              button.textContent = 'Copy';
    
              pre[i].appendChild(button);
        }
      };
    
      // Run Clipboard
    
      var copyCode = new Clipboard('.copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
    
      // On success:
      // - Change the "Copy" text to "Copied".
      // - Swap it to "Copy" in 2s.
      // - Lead user to the "contenteditable" area with Velocity scroll.
    
      copyCode.on('success', function(event) {
        event.clearSelection();
        event.trigger.textContent = 'Copied';
        window.setTimeout(function() {
          event.trigger.textContent = 'Copy';
        }, 2000);
    
      });
    
      // On error (Safari):
      // - Change the  "Press Ctrl+C to copy"
      // - Swap it to "Copy" in 2s.
    
      copyCode.on('error', function(event) {
        event.trigger.textContent = 'Press "Ctrl + C" to copy';
        window.setTimeout(function() {
          event.trigger.textContent = 'Copy';
        }, 5000);
      });
    
    })();
</script>
    
  </body>
</html>

<script>
  var coll = document.getElementsByClassName("collapsible");
  var i;

  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    });
  }
</script>

<script>
  var coll = document.getElementsByClassName("solutioncollapsible");
  const queryString = window.location.search;
  const urlParams = new URLSearchParams(queryString);
  const myVar = urlParams.get('solution')
  if ( myVar == 'true') {
    for (i = 0; i < coll.length; i++) {
      coll[i].style.display = "block";
    }
  }
</script>